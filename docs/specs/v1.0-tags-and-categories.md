## V1.0 Spec – Tags (P1) & Playlists (P2/P3)

### 1. Scope & Goals

**Milestone reference**: This spec defines **Tags** (P1) and **Playlists / Workouts** (P2/P3) as part of the organization model. Tags are metadata for skills; Playlists replace the former "categories" concept with a clearer user flow. See `docs/roadmap.md` for milestone placement.

**Decision**: Categories are **scrapped**. Instead:
- **Tags (P1)**: Simple metadata strings on skills (e.g. #Aim, #Positioning, #GameSense).
- **Playlists / Workouts (P2/P3)**: Curated skill sets with a clear user flow—"I'm playing Tank today, so I'll start my 'Tank Fundamentals' playlist."

**Why Playlists over Categories**: A playlist provides a **clear path** for the user rather than just a filtered list. Categories were a way to group skills; playlists are a way to **run** a session.

---

### 2. Tags (P1 Feature)

#### 2.1. Purpose

Tags are **metadata** for skills. Examples: #Aim, #Positioning, #GameSense, #Tank, #Support.

Use them for:
- Filtering skills in the list (e.g. "show me all positioning skills").
- Organizing skills by theme without heavyweight structure.
- Future search and browse (V1.4+).

#### 2.2. Data Model

**Simple string array on the Skill object:**

```ts
interface Skill {
  // ... existing fields
  tags: string[];  // e.g. ["Aim", "Positioning", "GameSense"]
}
```

**No separate Tag entity.** No `tagIds`, no `Tag` interface, no `owPractice.v1.tags` storage key. Tags live **only** on the skill.

#### 2.3. Tag Normalization (Optional but Recommended)

For consistent filtering and deduplication:

- **Trim** leading and trailing whitespace.
- **Lowercase** for storage/comparison, or preserve user casing for display (implementation choice).
- **Empty string** after trim is invalid—do not add.
- **Duplicate prevention**: Before adding a tag, normalize and check if it already exists on the skill (case-insensitive).

Implementation can keep display form (e.g. "Positioning") and normalize only for comparison.

#### 2.4. Storage

- No new storage keys. Tags are part of `owPractice.v1.skills`; each skill already has (or will have) a `tags` array.
- **Migration**: If existing skills use `tagIds` or `categoryIds`, migrate to `tags: string[]` on load (map IDs to labels, or derive from all skills' tag strings).

#### 2.5. UI Components

**SkillEditor** (extend):
- Tag input: User types a tag (e.g. "Aim") and confirms (Enter or blur).
- Display selected tags as removable chips/pills.
- Optional autocomplete from tags used across all skills (derived from `skills.flatMap(s => s.tags)`).

**SkillFiltersPanel** (extend):
- Tag filter: Multi-select from tags that exist across skills.
- "All" when none selected = no tag filter.
- Populate options from `[...new Set(skills.flatMap(s => s.tags))]`.

#### 2.6. Filter Logic

Update `SkillFilterCriteria` and `filterAndSortSkills`:

```ts
interface SkillFilterCriteria {
  roleIds?: RoleId[];
  heroIds?: HeroId[];
  tags?: string[];  // show skills that have ANY of these tags
  searchQuery?: string;
}
```

Filter: `skill.tags.some(tag => criteria.tags!.some(t => t.toLowerCase() === tag.toLowerCase()))` (or use normalized comparison).

---

### 3. Playlists / Workouts (P2/P3 Feature)

**Not implemented in P1.** This section defines the future feature for roadmap and spec compliance.

#### 3.1. Purpose

Replace the old "categories" concept with **Playlists** (or "Workouts")—curated sets of skills that the user activates for a session.

**User Flow**: "I'm playing Tank today, so I'll start my 'Tank Fundamentals' playlist."

**Why it's better than categories**:
- Categories were organizational labels; playlists are **actionable**.
- A playlist defines *which skills are active* for the timer—not just a filtered view.
- Clear mental model: "Start session" → "Choose playlist" → "Practice."

#### 3.2. Data Model (Future)

```ts
interface Playlist {
  id: string;
  name: string;           // e.g. "Tank Fundamentals"
  skillIds: string[];      // ordered list of skill IDs
  gameId: GameId;
  createdAt: string;
  updatedAt: string;
}
```

- User creates playlists with custom names.
- User adds/removes/reorders skills in a playlist.
- "Start playlist" = set active skills to those in the playlist; timer runs through them (or however the session flow is designed).

#### 3.3. Milestone Placement

**V1.2 – Personalization & Practice Flows** already includes "Practice Playlists / Loadouts." Playlists fit there. See `docs/roadmap.md` for full V1.2 scope.

---

### 4. Summary for Implementation (Tags P1)

For the engineer implementing Tags:

1. **Schema change**: Replace `tagIds` (and `categoryIds`) with `tags: string[]` on `Skill`.
2. **Migration**: If existing data has `tagIds`/`categoryIds`, migrate on load—either drop or map to strings (spec may need a separate migration doc if preserving legacy data).
3. **SkillEditor**: Add tag input with chips; add/remove tags on the skill.
4. **SkillFiltersPanel**: Add tag filter using tags derived from all skills.
5. **filterAndSortSkills**: Support `tags` in criteria; filter skills that have any of the selected tags.
6. **No new storage keys**: Tags live in skills.

---

### 5. Dependencies

- Parent spec: `docs/specs/v1.0-skill-model-2.0.md` (will need a follow-up to remove `categoryIds`/`tagIds` and add `tags`).
- Roadmap: Tags in V1.0; Playlists in V1.2.

---

### 6. Post-Spec: Categories Removed

**Removed from scope**:
- `Category` interface
- `CategoryId` type
- `categoryIds` on Skill
- `owPractice.v1.categories` storage
- CategoryManager component
- Category filter (replaced by tag filter)

Any existing code referencing categories should be removed or migrated as part of this change.
